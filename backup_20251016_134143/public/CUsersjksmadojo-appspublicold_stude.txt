<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Old Students</title>
  <style>
    body{font-family:system-ui,Arial;padding:20px}
    table{border-collapse:collapse;margin-top:12px;width:100%}
    th,td{border:1px solid #ccc;padding:6px}
    .back{display:inline-block;margin-bottom:12px}
  </style>
</head>
<body>
  <a class="back" href="index.html">â¬… Back to Main</a>
  <h2>Old Students (Archived)</h2>

  <table id="tbl">
    <thead><tr>
      <th>ID</th><th>Student ID</th><th>Name</th><th>Phone</th><th>Email</th>
      <th>Join</th><th>Renewal</th><th>Archived</th><th>Actions</th>
    </tr></thead>
    <tbody></tbody>
  </table>

<script>
async function load(){
  const r = await fetch('/api/old-students'); const rows = await r.json();
  const tb = document.querySelector('#tbl tbody'); tb.innerHTML='';
  if(!rows.length){ tb.innerHTML='<tr><td colspan="9">None archived.</td></tr>'; return; }
  for(const s of rows){
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${s.id}</td><td>${s.student_id}</td><td>${s.name||''}</td><td>${s.phone||''}</td><td>${s.email||''}</td>
      <td>${s.join_date||''}</td><td>${s.renewal_date||''}</td><td>${s.archived_at||''}</td>
      <td><button onclick="delOld(${s.id})">Delete</button></td>`;
    tb.appendChild(tr);
  }
}
async function delOld(id){
  if(!confirm('Delete archived record?')) return;
  await fetch(`/api/old-students/${id}`,{method:'DELETE'});
  await load();
}
load();
</script>
</body>
</html>
