<!-- payments.html build v2025-10-10-2 -->
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Payments</title>
  <link rel="stylesheet" href="styles.css?v=1" /><meta name="viewport" content="width=device-width, initial-scale=1" />

</head><body>
<h1>Payments</h1><p><a href="index.html">← Back to Main</a></p>
<h2>Add Payment</h2>
<div class="row">
  <select id="student"></select>
  <input id="amount" type="number" step="0.01" placeholder="Amount" />
  <select id="method"><option>cash</option><option>e-transfer</option><option>card</option><option>other</option></select>
  <label><input id="taxable" type="checkbox" /> Taxable</label>
  <input id="date" type="date" />
  <input id="notes" placeholder="Notes" />
  <button id="addBtn">Add Payment</button>
</div>
<h2>Payments List</h2>
<table id="payTable"><thead><tr><th>Date</th><th>Student</th><th>Amount</th><th>Method</th><th>Taxable</th><th>Notes</th><th>Actions</th></tr></thead><tbody></tbody></table>
<p>Marker: payments.html build v2025-10-10-2</p>
<script>
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
document.getElementById('date').value=new Date().toISOString().slice(0,10);
async function loadStudents(){const d=await (await fetch('/api/students?active=1')).json(); $('#student').innerHTML=d.map(s=>`<option value="${s.id}">${s.first_name||''} ${s.last_name||''}</option>`).join('')}
async function loadPayments(){const arr=await (await fetch('/api/payments')).json(); const tbody=$('#payTable tbody'); tbody.innerHTML=''; for(const p of arr){const tr=document.createElement('tr'); tr.innerHTML=`<td>${p.date||''}</td><td>${(p.first_name||'')+' '+(p.last_name||'')}</td><td>${(+p.amount).toFixed(2)}</td><td>${p.method||''}</td><td>${p.taxable?'Yes':'No'}</td><td>${p.notes||''}</td><td><button data-id="${p.id}" class="del">Delete</button></td>`; tbody.appendChild(tr)} $$('#payTable .del').forEach(b=>b.onclick=async()=>{await fetch('/api/payments/'+b.dataset.id,{method:'DELETE'}); loadPayments();})}
$('#addBtn').onclick=async()=>{const p={student_id:$('#student').value,amount:$('#amount').value,method:$('#method').value,taxable:$('#taxable').checked,date:$('#date').value,notes:$('#notes').value}; await fetch('/api/payments',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(p)}); $('#amount').value=''; $('#notes').value=''; loadPayments();}
loadStudents(); loadPayments();
</script>
</body></html>

