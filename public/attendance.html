<!-- attendance.html build v2025-10-10-2 -->
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Attendance</title>
  <link rel="stylesheet" href="styles.css?v=1" /><meta name="viewport" content="width=device-width, initial-scale=1" />

</head><body>
<h1>Attendance</h1><p><a href="index.html">← Back to Main</a></p>
<h2>Mark Attendance</h2>
<div class="row"><select id="studentSelect"></select><input id="date" type="date" /><label><input id="present" type="checkbox" checked /> Present</label><button id="markBtn">Mark</button></div>
<h2>Records</h2>
<table id="attTable"><thead><tr><th>Date</th><th>Student</th><th>Status</th><th>Actions</th></tr></thead><tbody></tbody></table>
<p>Marker: attendance.html build v2025-10-10-2</p>
<script>
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
document.getElementById('date').value=new Date().toISOString().slice(0,10);
async function loadStudents(){const d=await (await fetch('/api/students?active=1')).json(); $('#studentSelect').innerHTML=d.map(s=>`<option value="${s.id}">${s.first_name||''} ${s.last_name||''}</option>`).join('')}
async function loadAttendance(){const arr=await (await fetch('/api/attendance')).json(); const tbody=$('#attTable tbody'); tbody.innerHTML=''; for(const a of arr){const tr=document.createElement('tr'); tr.innerHTML=`<td>${a.date||''}</td><td>${(a.first_name||'')+' '+(a.last_name||'')}</td><td>${a.present?'Present':'Absent'}</td><td><button data-id="${a.id}" class="del">Delete</button></td>`; tbody.appendChild(tr)} $$('#attTable .del').forEach(b=>b.onclick=async()=>{await fetch('/api/attendance/'+b.dataset.id,{method:'DELETE'}); loadAttendance();})}
$('#markBtn').onclick=async()=>{const p={student_id:$('#studentSelect').value,date:$('#date').value,present:$('#present').checked}; await fetch('/api/attendance',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(p)}); loadAttendance();}
loadStudents(); loadAttendance();
</script>
</body></html>

