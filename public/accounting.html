<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Accounting</title>
<link rel="stylesheet" href="main.css"/>
</head><body><div class="container">
  <h1>Accounting</h1>
  <div class="card">
    <div class="toolbar">
      <label>From <input type="date" id="from"></label>
      <label>To <input type="date" id="to"></label>
      <button class="btn btn-primary" id="run">Run</button>
      <button class="btn" id="clear">Clear</button>
    </div>
    <div id="out" class="grid"></div>
  </div>
  <p><a href="index.html">Back to Main</a></p>
</div>
<script>
const $=s=>document.querySelector(s);
function money(n){ return (n||0).toLocaleString(undefined,{style:'currency',currency:'USD'}); }
async function run(){
  const from = $("#from").value, to = $("#to").value;
  const q = new URLSearchParams(); if(from) q.set("from",from); if(to) q.set("to",to);
  const res = await fetch("/api/accounting/summary?"+q.toString());
  const z = await res.json();
  $("#out").innerHTML = `
    <div class="card"><h2>Income</h2>
      <p>Taxable: <b>${money(z.incomeTaxable)}</b></p>
      <p>Non-Taxable: <b>${money(z.incomeNonTaxable)}</b></p>
      <p>Total: <b>${money(z.incomeTotal)}</b></p>
    </div>
    <div class="card"><h2>Expenses</h2>
      <p>Taxable: <b>${money(z.expenseTaxable)}</b></p>
      <p>Non-Taxable: <b>${money(z.expenseNonTaxable)}</b></p>
      <p>Total: <b>${money(z.expenseTotal)}</b></p>
    </div>
    <div class="card"><h2>Net</h2>
      <p><b>${money(z.net)}</b></p>
    </div>`;
}
document.getElementById("run").onclick = run;
document.getElementById("clear").onclick = ()=>{ $("#from").value=""; $("#to").value=""; run(); };
run();
</script>
</body></html>